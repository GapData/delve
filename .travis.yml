sudo: true
dist: xenial
language: python
python:
- '3.6'
- '3.7'
git:
  depth: false
env:
- MPLBACKEND=Agg
cache: pip
install:
- if [[ "$TRAVIS_PYTHON_VERSION" == "2.7" ]]; then wget https://repo.continuum.io/miniconda/Miniconda2-latest-Linux-x86_64.sh
  -O miniconda.sh; else wget https://repo.continuum.io/miniconda/Miniconda3-latest-Linux-x86_64.sh
  -O miniconda.sh; fi
- bash miniconda.sh -b -p $HOME/miniconda
- export PATH="$HOME/miniconda/bin:$PATH"
- hash -r
- conda config --set always_yes yes --set changeps1 no
- conda update -q conda
- conda create -q -n test-environment python=$TRAVIS_PYTHON_VERSION chainer pytorch-cpu
  torchvision-cpu -c pytorch
- source activate test-environment
- pip install moviepy==0.2.3.2
- pip install matplotlib
- python -c "import imageio; imageio.plugins.ffmpeg.download()"
- pip install --upgrade pytest flake8
- pip install .
script:
- python example_fc.py
deploy:
  provider: pypi
  user: jshenk
  skip_cleanup: true
  on:
    tags: true
    branch: master
  password:
    secure: WCW0AGDIMXDoCIVfOw4gnVbTJAYddkt63yZv19VZXfhPYm2moNOCkQEOJqhkn3FTXANcCDEiUol6I5YBGZMeNLd3Dg/eqjQ79PxXYm9xIez8ULgC3nEtIvR9/6iJ+bVSFfr77kefh/6N7dLPeO9+eDAGmcTJSECPcLE8h3Bl+4cVe3Dy9Fv6vxEeZ41etXFvKE/JOOK+NOEJsE40kWOSq6UVN1jGlpxH/xQnzBfkr1/mOBQPRw7XRxN6tkXpt3qb86NUMx6sk2SbW6nAWSIxOEi+3tQOoNPV+H/niX6YTyC86izVWeqri6uiMOX/uT0aMf0Gdf7/MyTFh/FqA3StqJnZoJAn83yi21WbIdKKWSx/57hQ3B2l5R3LS2ZLpVW0rPzzE52F+SJF+rcK9ZQT9Eh7A5IxTn0sPIa0YV3XX48wWEsx7WzrO3g5UzZbaGz9hdhT4XpjjufqduFACZO8J+EES2mUa0zB1Wi1R7OUqTXYWxgHlv85CF8E+9Mb7E1eiCy0z452JsTVCWnAq4q0acN+VFlqfwgo3qO0gCDUNRsFev+NFLgEu05ByPyXPW97i1VbWIIdJwUjt848hcy4NUBr/kHdFuVTCD4ox5j9DsDXjTWbOvvZ+WbhHVdnnZW5YW1UscLokB3yyhX+oWmKSMi/G21OLLaDcCc8vzUOKH8=
